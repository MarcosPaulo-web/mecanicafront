<main class="container-xxl pt-5">
  <app-loading [show]="loading" message="Carregando clientes..." />

  <div class="row align-items-center">
    <div class="col-6 text-start">
      <app-titulo title="Clientes" subtitle="Gerencie o cadastro de clientes" />
    </div>
    <div class="col-6 text-end">
      <button class="btn btn-primary-mecanica" (click)="abrirModalNovo()">
        <i class="bi bi-plus-lg"></i> Novo cliente
      </button>
    </div>
  </div>

  <div class="row mt-5 rounded-4 border border-body p-4">
    <div class="col-12">
      <app-input-pesquisa
        (pesquisa)="filtrarClientes($event)"
        label="Pesquise por nome, email ou CPF..."
      />
    </div>
  </div>

  <div class="row border border-body rounded-4 pt-3 mt-5">
    @if (clientesFiltrados.length === 0) {
    <div class="col-12 text-center py-5">
      <i class="bi bi-inbox fs-1 text-muted"></i>
      <p class="text-muted mt-3">Nenhum cliente encontrado</p>
    </div>
    } @else {
    <app-tabela [cabecario]="colunas">
      @for (cliente of clientesFiltrados; track cliente.cdCliente) {
      <tr>
        <td>{{ cliente.nmCliente }}</td>
        <td>{{ cliente.nuCPF | cpf || '-' }}</td>
        <td>{{ cliente.nuTelefone | telefone || '-' }}</td>
        <td>{{ cliente.email || '-' }}</td>
        <td>{{ cliente.dsEndereco || '-' }}</td>
        <td>
          <button class="btn" (click)="abrirModalEditar(cliente)">
            <i class="bi bi-pencil-square"></i>
          </button>
          <button class="btn text-danger" (click)="deletarCliente(cliente)">
            <i class="bi bi-trash"></i>
          </button>
        </td>
      </tr>
      }
    </app-tabela>
    }
  </div>

  <app-modal-cliente
    [cliente]="clienteSelecionado"
    (salvar)="salvarCliente($event)"
    (fechar)="clienteSelecionado = undefined"
  />
</main>